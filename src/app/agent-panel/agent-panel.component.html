<!-- <div class="app-container">
  Sidebar
  <div class="sidebar">
    <div class="sidebar-header">
      <h1>Agent-Panel</h1>
    </div>
    <div class="sidebar-nav">
      <a class="sidebar-nav-item active" routerLink="/dashboard">
        <i class="material-icons">dashboard</i>
        <span>Dashboard</span>
      </a>
      <a class="sidebar-nav-item" (click)="toggleCreateForm()">
        <i class="material-icons">person_add</i>
        <span>{{ showCreateForm ? 'Cancel' : 'Add New User' }}</span>
      </a>
      <a class="sidebar-nav-item" routerLink="/recycle-bin">
        <i class="material-icons">delete</i>
        <span>Recycle Bin</span>
      </a>
      <a class="sidebar-nav-item" routerLink="/settings">
        <i class="material-icons">settings</i>
        <span>Settings</span>
      </a> -->
    <!-- </div>
    <div class="sidebar-footer">
      <button class="logout-btn" (click)="logout()">
        <i class="material-icons">exit_to_app</i>
        <span>Logout</span>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <!-- <div class="main-content">
    <div class="header">
      <h1>Agent Users</h1>
    </div> -->

    <!-- Alert Messages -->
    <!-- <div *ngIf="errorMessage" class="alert alert-danger">
      <span>{{ errorMessage }}</span>
      <button class="close-btn" (click)="errorMessage = ''">×</button>
    </div> -->

    <!-- <div *ngIf="successMessage" class="alert alert-success">
      <span>{{ successMessage }}</span>
      <button class="close-btn" (click)="successMessage = ''">×</button>
    </div> -->

    <!-- Create User Form -->
    <!-- <div class="create-form" *ngIf="showCreateForm">
      <h2>Create New User</h2>
      <div class="form-grid">
        <div class="form-group">
          <label for="name">First Name</label>
          <input type="text" id="name" [(ngModel)]="name" placeholder="First Name">
        </div> --> -->

        <!-- <div class="form-group">
          <label for="lastname">Last Name</label>
          <input type="text" id="lastname" [(ngModel)]="lastname" placeholder="Last Name">
        </div>

        <div class="form-group">
          <label for="phonenumber">Phone</label>
          <input type="text" id="phonenumber" [(ngModel)]="phonenumber" placeholder="Phone Number">
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" [(ngModel)]="email" placeholder="Email">
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" [(ngModel)]="password" placeholder="Password">
        </div>
      </div>

      <div class="form-actions">
        <button class="btn btn-secondary" (click)="resetForm()">Clear</button>
        <button class="btn btn-primary" (click)="createUser()">Create User</button>
      </div>
    </div> -->

    <!-- User List -->
    <!-- <div class="user-list-container">
      <h2>Agent Users</h2>

      <div *ngIf="isLoading" class="loading-spinner">
        <div class="spinner"></div>
        <p>Loading users...</p>
      </div>

      <div *ngIf="!isLoading && users.length === 0" class="no-users">
        <p>No users found. Add a new user to get started.</p>
      </div>

      <div *ngIf="!isLoading && users.length > 0" class="user-list" [@listAnimation]="users.length">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Created</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of users" [class.disabled]="user.isDisabled">
              <td>{{ user.name }} {{ user.lastname }}</td>
              <td>{{ user.email }}</td>
              <td>{{ user.phonenumber }}</td>
              <td>{{ user.createdAt | date:'medium' }}</td>
              <td>
                <span class="status-badge" [class.active]="!user.isDisabled" [class.inactive]="user.isDisabled">
                  {{ user.isDisabled ? 'Disabled' : 'Active' }}
                </span>
              </td>
              <td class="actions">
                <button class="btn-icon" [ngClass]="{'active': !user.isDisabled}" [title]="user.isDisabled ? 'Enable User' : 'Disable User'"
                        (click)="toggleUserStatus(user)">
                  <i class="material-icons">{{ user.isDisabled ? 'toggle_off' : 'toggle_on' }}</i>
                </button>
                <button class="btn-icon delete" title="Delete User" (click)="deleteUser(user.id)">
                  <i class="material-icons">delete</i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div> -->

    <!-- Delete Confirmation Modal -->
    <!-- <div class="modal-overlay" *ngIf="showDeleteConfirmation">
      <div class="modal-container">
        <div class="modal-header">
          <h3>Confirm Delete</h3>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this user? This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" (click)="cancelDelete()">Cancel</button>
          <button class="btn btn-danger" (click)="confirmDelete()">Delete</button>
        </div>
      </div>
    </div>
  </div>
</div> -->

<div class="app-container">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <h1>Agent-Panel</h1>
    </div>
    <div class="sidebar-nav">
      <a class="sidebar-nav-item" [class.active]="currentView === 'dashboard'" (click)="setCurrentView('dashboard')">
        <i class="material-icons">dashboard</i>
        <span>Dashboard</span>
      </a>
      <a class="sidebar-nav-item" [class.active]="currentView === 'users'" (click)="setCurrentView('users')">
        <i class="material-icons">people</i>
        <span>Agent Users</span>
      </a>
      <a class="sidebar-nav-item" [class.active]="currentView === 'createUser'" (click)="setCurrentView('createUser')">
        <i class="material-icons">person_add</i>
        <span>Add New User</span>
      </a>
      <a class="sidebar-nav-item" routerLink="/recycle-bin">
        <i class="material-icons">delete</i>
        <span>Recycle Bin</span>
      </a>
      <a class="sidebar-nav-item" routerLink="/settings">
        <i class="material-icons">settings</i>
        <span>Settings</span>
      </a>
    </div>
    <div class="sidebar-footer">
      <button class="logout-btn" (click)="logout()">
        <i class="material-icons">exit_to_app</i>
        <span>Logout</span>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="header">
      <h1>
        {{ currentView === 'dashboard' ? 'Agent Dashboard' :
           currentView === 'users' ? 'Agent Users' :
           currentView === 'createUser' ? 'Create New User' : 'Agent Panel' }}
      </h1>
    </div>

    <!-- Alert Messages -->
    <div *ngIf="errorMessage" class="alert alert-danger">
      <span>{{ errorMessage }}</span>
      <button class="close-btn" (click)="errorMessage = ''">×</button>
    </div>

    <div *ngIf="successMessage" class="alert alert-success">
      <span>{{ successMessage }}</span>
      <button class="close-btn" (click)="successMessage = ''">×</button>
    </div>

    <!-- Dashboard content - will be conditionally displayed -->
    <div *ngIf="currentView === 'dashboard'" class="dashboard-view">
      <!-- Rental Dashboard Section -->
      <div class="rental-dashboard">
        <div class="total-daily-rentals">
          <div class="app-activations">
            <span class="label">App activations</span>
            <span class="value">{{ rentalData[rentalData.length - 1].appActivations }}</span>
          </div>
          <div class="app-deactivations">
            <span class="label">App deactivations</span>
            <span class="value">{{ rentalData[rentalData.length - 1].appDeactivations }}</span>
          </div>
        </div>

        <div class="rental-chart">
          <canvas #rentalChart></canvas>
        </div>

        <div class="monthly-rentals">
          <h3>Monthly Rentals - February 2025</h3>
          <table>
            <thead>
              <tr>
                <th>Agreements</th>
                <th>Accumulated Days</th>
                <th>Average Days per Agreement</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{{ monthlyRentalSummary.agreements }}</td>
                <td>{{ monthlyRentalSummary.accumulatedDays }}</td>
                <td>{{ monthlyRentalSummary.averageDaysPerAgreement }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Agent Users List - conditionally displayed -->
    <div *ngIf="currentView === 'users'" class="users-view">
      <div class="user-list-container">
        <div class="user-actions">
          <button class="btn btn-primary" (click)="setCurrentView('createUser')">
            <i class="material-icons">add</i> Add New User
          </button>
        </div>

        <div *ngIf="isLoading" class="loading-spinner">
          <div class="spinner"></div>
          <p>Loading users...</p>
        </div>

        <div *ngIf="!isLoading && users.length === 0" class="no-users">
          <p>No users found. Add a new user to get started.</p>
        </div>

        <div *ngIf="!isLoading && users.length > 0" class="user-list" [@listAnimation]="users.length">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Country</th>
                <th>City</th>
                <th>Created</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of users" [class.disabled]="user.isDisabled">
                <td>{{ user.name }} {{ user.lastname }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.phonenumber }}</td>
                <td>{{ user.country }}</td>
                <td>{{ user.city }}</td>
                <td>{{ user.createdAt | date:'medium' }}</td>
                <td>
                  <span class="status-badge" [class.active]="!user.isDisabled" [class.inactive]="user.isDisabled">
                    {{ user.isDisabled ? 'Disabled' : 'Active' }}
                  </span>
                </td>
                <td class="actions">
                  <button class="btn-icon" [ngClass]="{'active': !user.isDisabled}" [title]="user.isDisabled ? 'Enable User' : 'Disable User'"
                          (click)="toggleUserStatus(user)">
                    <i class="material-icons">{{ user.isDisabled ? 'toggle_off' : 'toggle_on' }}</i>
                  </button>
                  <button class="btn-icon delete" title="Delete User" (click)="deleteUser(user.id)">
                    <i class="material-icons">delete</i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Create user form - conditionally displayed -->
    <div *ngIf="currentView === 'createUser'" class="create-user-view">
      <div class="create-form">
        <div class="form-grid">
          <div class="form-group">
            <label for="name">First Name</label>
            <input type="text" id="name" [(ngModel)]="name" placeholder="First Name">
          </div>

          <div class="form-group">
            <label for="lastname">Last Name</label>
            <input type="text" id="lastname" [(ngModel)]="lastname" placeholder="Last Name">
          </div>

          <div class="form-group">
            <label for="phonenumber">Phone</label>
            <input type="text" id="phonenumber" [(ngModel)]="phonenumber" placeholder="Phone Number">
          </div>

          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" [(ngModel)]="email" placeholder="Email">
          </div>

          <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password" [(ngModel)]="password" placeholder="Password">
          </div>

          <div class="form-group">
            <label for="country">Country</label>
            <input type="text" id="country" [(ngModel)]="country" placeholder="Country">
          </div>

          <div class="form-group">
            <label for="city">City</label>
            <input type="text" id="city" [(ngModel)]="city" placeholder="City">
          </div>
        </div>

        <div class="form-actions">
          <button class="btn btn-secondary" (click)="resetForm()">Clear</button>
          <button class="btn btn-primary" (click)="createUser()">Create User</button>
          <button class="btn btn-outline" (click)="setCurrentView('users')">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" *ngIf="showDeleteConfirmation">
      <div class="modal-container">
        <div class="modal-header">
          <h3>Confirm Delete</h3>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this user? This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" (click)="cancelDelete()">Cancel</button>
          <button class="btn btn-danger" (click)="confirmDelete()">Delete</button>
        </div>
      </div>
    </div>
  </div>
